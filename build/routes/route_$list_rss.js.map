{"version":3,"file":"route_$list_rss.js","sources":["../../../unoptimized/server/web_modules/node-fetch.js","../../../unoptimized/server/_app/routes/[list]/rss.js"],"sourcesContent":["// native patch for: node-fetch, whatwg-fetch\n// ref: https://github.com/tc39/proposal-global\nvar getGlobal = function () {\n  if (typeof self !== 'undefined') { return self; }\n  if (typeof window !== 'undefined') { return window; }\n  if (typeof global !== 'undefined') { return global; }\n  throw new Error('unable to locate global object');\n};\nvar global = getGlobal();\nvar index = global.fetch.bind(global);\nconst Headers = global.Headers;\nconst Request = global.Request;\nconst Response = global.Response;\n\nexport default index;\nexport { Headers, Request, Response };\n","import fetch from '../../../web_modules/node-fetch.js';\n\nconst render = (list, items) => `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<rss version=\"2.0\">\n<channel>\n\t<title>Svelte HN (${list})</title>\n\t<link>https://hn.svelte.dev/${list}/1</link>\n\t<description>Links from the orange site</description>\n\t<image>\n\t\t<url>https://hn.svelte.dev/favicon.png</url>\n\t\t<title>Svelte HN (${list})</title>\n\t\t<link>https://hn.svelte.dev/${list}/1</link>\n\t</image>\n\t${items.map(item => `\n\t\t<item>\n\t\t\t<title>${item.title}${item.domain ? ` (${item.domain})` : ''}</title>\n\t\t\t<link>https://hn.svelte.dev/item/${item.id}</link>\n\t\t\t<description><![CDATA[${\n\t\t\t\titem.url ? `<a href=\"${item.url}\">link</a> / ` : ''\n\t\t\t\t}<a href=\"https://hn.svelte.dev/item/${item.id}\">comments</a>\n\t\t\t]]></description>\n\t\t\t<pubDate>${new Date(item.time * 1000).toUTCString()}</pubDate>\n\t\t</item>\n\t`).join('\\n')}\n</channel>\n</rss>`;\n\nexport function get(req, res) {\n\tconst list = (\n\t\treq.params.list === 'top' ? 'news' :\n\t\treq.params.list === 'new' ? 'newest' :\n\t\treq.params.list\n\t);\n\n\tfetch(`https://api.hnpwa.com/v0/${list}/1.json`)\n\t\t.then(r => r.json())\n\t\t.then(items => {\n\t\t\tconst feed = render(list, items);\n\t\t\treturn {\n\t\t\t\tbody: feed,\n\t\t\t\theaders: {\n\t\t\t\t\t'Cache-Control': `max-age=0, s-max-age=${600}`, // 10 minutes\n\t\t\t\t\t'Content-Type': 'application/rss+xml'\n\t\t\t\t}\n\t\t\t};\n\t\t});\n}\n"],"names":["global","self","window","Error","getGlobal","index","fetch","bind","Headers","Request","Response","req","res","list","params","then","r","json","items","body","map","item","title","domain","id","url","Date","time","toUTCString","join","render","headers","Cache-Control","Content-Type"],"mappings":"oEAEA,IAMIA,EANY,WACd,GAAoB,oBAATC,KAAwB,OAAOA,KAC1C,GAAsB,oBAAXC,OAA0B,OAAOA,OAC5C,QAAsB,IAAXF,EAA0B,OAAOA,EAC5C,MAAM,IAAIG,MAAM,kCAELC,GACTC,EAAQL,EAAOM,MAAMC,KAAKP,GACdA,EAAOQ,QACPR,EAAOS,QACNT,EAAOU,qBCejB,SAAaC,EAAKC,GACxB,MAAMC,EACe,QAApBF,EAAIG,OAAOD,KAAiB,OACR,QAApBF,EAAIG,OAAOD,KAAiB,SAC5BF,EAAIG,OAAOD,KAGZP,EAAM,4BAA4BO,YAChCE,MAAKC,GAAKA,EAAEC,SACZF,MAAKG,IAEE,CACNC,KArCW,EAACN,EAAMK,IAAU,gGAGXL,6CACUA,2JAITA,+CACUA,6BAE7BK,EAAME,KAAIC,GAAQ,8BAETA,EAAKC,QAAQD,EAAKE,OAAS,KAAKF,EAAKE,UAAY,sDACvBF,EAAKG,0CAEvCH,EAAKI,IAAM,YAAYJ,EAAKI,mBAAqB,yCACVJ,EAAKG,6DAElC,IAAIE,KAAiB,IAAZL,EAAKM,MAAaC,6CAErCC,KAAK,4BAcOC,CAAOjB,EAAMK,GAGzBa,QAAS,CACRC,gBAAiB,2BACjBC,eAAgB"}